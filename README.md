je veux api je envoie des param (groupNum ,groupName de table client et name de table Subsidiary, id de etat mois de letat ou date detat ) idEtat =1 si generateAccountInterestReport, idEtat=2 si generateArretelntraGroupeReport idEtat=3 si generateCumulativeLevelingsReport idEtat=4 si generateCumulativeLevelingsGroupReport idEtat=5 si generateLoanBorrowing Report idEtat=6 si generateLoanBorrowingGroupReport pour letat 1,2,,3et 4 je besoin le mois et pour le autre jai besoin de date pas de mois voila le foction qui generere les etat je veux une api qui regroupe tous les api deja exitant et qui genere letat demander quand je clique sur recherche voila mmon code deja exitant je vous envoie sur des parties jevous demande de mattender jusqua je termine tous les partie et apres me generer la reponse @RestController @RequestMapping("/api/states") @CrossOrigin(origins = "*") public class StateController { @Autowired InterestCalculationService interestCalculationServiceImpl; @Autowired CumulativeLevelingsService cumulativeLevelingsServiceImpl; private SubsidiaryServiceFeign subsidiaryServiceFeign; @GetMapping("/account-interest") public ResponseEntity<InputStreamResource> generateAccountInterestReport() { try { DateTimeFormatter formatter = DateTimeFormatter.ofPattern("dd/MM/yyyy"); List<AccountInterestDetailsEtat> calculationRows = new ArrayList<>(); List<InterestCalculationRowEtat> interestCalculationRowEtats = new ArrayList<>(); InterestReport report = interestCalculationServiceImpl.calculateMonthlyInterestReport(1L, 1L, YearMonth.of(2024, 6)); report.getAccountDetails() .forEach((s, accountInterestDetails) -> { if (accountInterestDetails != null) { if (accountInterestDetails.getCalculationRows() != null) { accountInterestDetails.getCalculationRows() .forEach(cal -> { if (cal != null) { InterestCalculationRowEtat interestCalculationRowEtat = new InterestCalculationRowEtat(); interestCalculationRowEtat.setAncien_solde(accountInterestDetails.getInitialBalance()); interestCalculationRowEtat.setDate_val(cal.getValueDate()); interestCalculationRowEtat.setCapitaux(cal.getCapital()); interestCalculationRowEtat.setSolde(cal.getBalance()); interestCalculationRowEtat.setJour(cal.getDays()); interestCalculationRowEtat.setNombres(cal.getNumbers()); interestCalculationRowEtat.setTaux_debit(cal.getDebitInterest() .compareTo(BigDecimal.ZERO) != 0 ? cal.getDebitRate() : null); interestCalculationRowEtat.setTaux_credit(cal.getCreditInterest() .compareTo(BigDecimal.ZERO) != 0 ? cal.getCreditRate() : null); interestCalculationRowEtat.setInteret_debit(cal.getDebitInterest() .compareTo(BigDecimal.ZERO) != 0 ? cal.getDebitInterest() : null); interestCalculationRowEtat.setInteret_credit(cal.getCreditInterest() .compareTo(BigDecimal.ZERO) != 0 ? cal.getCreditInterest() : null); interestCalculationRowEtats.add(interestCalculationRowEtat); } }); } } }); calculationRows.add(new AccountInterestDetailsEtat("MAROC", "CASABLANCA", "2 RUE AL ABTAL", " , HAY ERRAHA", "CASABLANCA", report.getReportReference(), report.getAttachedEntityGroupName(), "EMAPHOS", report.getGroupName(), LocalDate.parse("01/06/2024", formatter), LocalDate.parse("30/06/2024", formatter), report.getCurrency(), "022780000140002797376074", "SGMBMAMC SOCIETE GENERALE MAROCAINE DE BANQUE", new BigDecimal(10), new BigDecimal("140998.19"), new BigDecimal("25833.07"), new BigDecimal("126898.37"), new BigDecimal("23249.76"), new BigDecimal("2583.31"), new BigDecimal("14099.82"), new BigDecimal("126898.37"), new BigDecimal("126898.37"), new BigDecimal("25833.07"), 30, new BigDecimal("25833.07"), new BigDecimal("25833.07"), new BigDecimal("25833.07") , interestCalculationRowEtats)); JRBeanCollectionDataSource dataSource = new JRBeanCollectionDataSource(calculationRows); JRBeanCollectionDataSource subReportDataSource = new JRBeanCollectionDataSource(interestCalculationRowEtats); Map<String, Object> parameters = new HashMap<>(); parameters.put("tableDataSource", subReportDataSource); parameters.put("pay", calculationRows.get(0) .getPay()); parameters.put("ville", calculationRows.get(0) .getVille()); parameters.put("adr1", calculationRows.get(0) .getAdr1()); parameters.put("adr2", calculationRows.get(0) .getAdr2()); parameters.put("adr3", calculationRows.get(0) .getAdr3()); parameters.put("ref", calculationRows.get(0) .getRef()); parameters.put("rattach", calculationRows.get(0) .getRattach()); parameters.put("sub_name", calculationRows.get(0) .getSub_name()); parameters.put("pivot", calculationRows.get(0) .getPivot()); parameters.put("first_date", calculationRows.get(0) .getFirst_date()); parameters.put("last_date", calculationRows.get(0) .getLast_date()); parameters.put("devise", calculationRows.get(0) .getDevise()); report.getAccountDetails() .forEach((s, accountInterestDetails) -> { if (accountInterestDetails != null) { parameters.put("taux", accountInterestDetails.getWithholdingTax()); parameters.put("montant_b_d", accountInterestDetails.getGrossDebitAmount()); parameters.put("montant_b_c", accountInterestDetails.getGrossCreditAmount()); parameters.put("montant_n_d", accountInterestDetails.getNetDebitAmount()); parameters.put("montant_n_c", accountInterestDetails.getNetCreditAmount()); parameters.put("mon_rsa_c", accountInterestDetails.getRetainedCreditAmount()); parameters.put("mon_rsa_d", accountInterestDetails.getRetainedDebitAmount()); parameters.put("montant_in_d", accountInterestDetails.getAmountToBeChargedDebit()); parameters.put("montant_in_c", accountInterestDetails.getAmountToBeChargedCredit()); } }); parameters.put("taux", calculationRows.get(0) .getTaux()); parameters.put("montant_b_d", calculationRows.get(0) .getMontant_b_d()); parameters.put("montant_b_c", calculationRows.get(0) .getMontant_b_c()); parameters.put("montant_n_d", calculationRows.get(0) .getMontant_n_d()); parameters.put("montant_n_c", calculationRows.get(0) .getMontant_n_c()); parameters.put("mon_rsa_c", calculationRows.get(0) .getMon_rsa_c()); parameters.put("mon_rsa_d", calculationRows.get(0) .getMon_rsa_d()); parameters.put("montant_in_d", calculationRows.get(0) .getMontant_in_d()); parameters.put("montant_in_c", calculationRows.get(0) .getMontant_in_c()); parameters.put("total_cap", calculationRows.get(0) .getTotal_cap()); parameters.put("total_jrs", calculationRows.get(0) .getTotal_jrs()); parameters.put("total_numbrs", calculationRows.get(0) .getTotal_numbrs()); parameters.put("total_id", calculationRows.get(0) .getTotal_id()); parameters.put("total_ic", calculationRows.get(0) .getTotal_ic()); InputStream jasperStream = this.getClass() .getResourceAsStream("/IntertsIntraGroupe.jrxml"); JasperReport jasperReport = JasperCompileManager.compileReport(jasperStream); JasperPrint jasperPrint = JasperFillManager.fillReport(jasperReport, parameters, dataSource); ByteArrayOutputStream pdfOutputStream = new ByteArrayOutputStream(); JasperExportManager.exportReportToPdfStream(jasperPrint, pdfOutputStream); ByteArrayInputStream bis = new ByteArrayInputStream(pdfOutputStream.toByteArray()); HttpHeaders headers = new HttpHeaders(); headers.add("Content-Disposition", "inline; filename=account-interest-report.pdf"); File outputDir = new File( "engine-service/src/main/resources/reports"); if (!outputDir.exists()) { outputDir.mkdirs(); } String outputFilePath = "engine-service/src/main/resources/reports/EtatDetaileInteretIG.pdf"; JasperExportManager.exportReportToPdfFile(jasperPrint, outputFilePath); return ResponseEntity .ok() .headers(headers) .contentType(MediaType.APPLICATION_PDF) .body(new InputStreamResource(bis)); } catch (Exception e) { e.printStackTrace(); return ResponseEntity.status(500) .build(); } }

*******************************************************************************************************************************


@GetMapping("/arrete-intraGroupe") public ResponseEntity<InputStreamResource> generateArreteIntraGroupeReport() { try { final BigDecimal[] netInterstDebit = {BigDecimal.ZERO}; final BigDecimal[] netInterstCredit = {BigDecimal.ZERO}; List<InterestReport> listReport = new ArrayList<>(); for (Long i = 1L; i < 5L; i++) { InterestReport reportx = interestCalculationServiceImpl.calculateMonthlyInterestReport(1L, i, YearMonth.of(2024, 6)); listReport.add(reportx); } List<InterestReport> intrestReport = new ArrayList<>(); List<AccountInterestDetails> interests = new ArrayList<>(); final String[] currency = {""}; final String[] reportReference = {""}; final String[] groupName = {""}; final String[] pivotAddress = {""}; final String[] pivotAccountNumber = {""}; final LocalDate[] dates = {null, null}; listReport.forEach(rep -> { currency[0] = rep.getCurrency(); reportReference[0] = rep.getReportReference(); groupName[0] = rep.getGroupName(); pivotAddress[0]=rep.getPivotAddress(); LocalDate[] extractedDates = extractDates(rep.getCalculationPeriod()); dates[0] = extractedDates[0]; dates[1] = extractedDates[1]; pivotAccountNumber[0]=rep.getPivotAccountNumber(); rep.getAccountDetails() .forEach((s, accountInterestDetails) -> { if (accountInterestDetails != null) { AccountInterestDetails interest = new AccountInterestDetails(); interest.setAccountName(accountInterestDetails.getAccountName()); interest.setAccountNumber(accountInterestDetails.getAccountNumber()); interest.setAmountToBeChargedCredit(accountInterestDetails.getAmountToBeChargedCredit()); interest.setAmountToBeChargedDebit(accountInterestDetails.getAmountToBeChargedDebit()); interest.setGrossCreditAmount(accountInterestDetails.getGrossCreditAmount()); interest.setGrossDebitAmount(accountInterestDetails.getGrossDebitAmount()); interest.setRetainedCreditAmount(accountInterestDetails.getRetainedCreditAmount()); interest.setRetainedDebitAmount(accountInterestDetails.getRetainedDebitAmount()); interest.setWithholdingTax(accountInterestDetails.getWithholdingTax()); interests.add(interest); netInterstDebit[0] = netInterstDebit[0].add(accountInterestDetails.getGrossCreditAmount()); netInterstCredit[0] = netInterstCredit[0].add(accountInterestDetails.getGrossDebitAmount()); } }); } ); Map<String, AccountInterestDetails> interestMap = interests.stream() .collect(Collectors.toMap(AccountInterestDetails::getAccountNumber, account -> account)); intrestReport.add(new InterestReport(currency[0], "", groupName[0], "03340 - 26449 - 00000 - AIG - RG", "", "",netInterstDebit[0], netInterstCredit[0],pivotAddress[0],pivotAccountNumber[0],dates[0],dates[1], interestMap)); JRBeanCollectionDataSource dataSource = new JRBeanCollectionDataSource(intrestReport); JRBeanCollectionDataSource subReportDataSource = new JRBeanCollectionDataSource(interests); Map<String, Object> parameters = new HashMap<>(); parameters.put("tableDataSource", subReportDataSource); parameters.put("pivotAddress", intrestReport.get(0) .getPivotAddress()); parameters.put("reportReference", intrestReport.get(0) .getReportReference()); parameters.put("pivot", intrestReport.get(0) .getGroupName()); parameters.put("pivotAccountNumber", intrestReport.get(0) .getPivotAccountNumber()); parameters.put("firstDate", dates[0]); parameters.put("lastDate", dates[1]); parameters.put("devise", intrestReport.get(0) .getCurrency()); parameters.put("netInterstDebit", netInterstDebit[0]); parameters.put("netInterstCredit", netInterstCredit[0]); InputStream jasperStream = this.getClass() .getResourceAsStream("/intra-groupOrders.jrxml"); JasperReport jasperReport = JasperCompileManager.compileReport(jasperStream); JasperPrint jasperPrint = JasperFillManager.fillReport(jasperReport, parameters, dataSource); File outputDir = new File("engine-service/src/main/resources/reports"); if (!outputDir.exists()) { boolean created = outputDir.mkdirs(); System.out.println("Répertoire créé : " + created); } String outputFilePath = "engine-service/src/main/resources/reports/EtatArretesIntraGroupe.pdf"; JasperExportManager.exportReportToPdfFile(jasperPrint, outputFilePath); System.out.println("Fichier PDF généré avec succès : " + outputFilePath); ByteArrayOutputStream pdfOutputStream = new ByteArrayOutputStream(); JasperExportManager.exportReportToPdfStream(jasperPrint, pdfOutputStream); ByteArrayInputStream bis = new ByteArrayInputStream(pdfOutputStream.toByteArray()); HttpHeaders headers = new HttpHeaders(); headers.add("Content-Disposition", "inline; filename=intra-group-report.pdf"); return ResponseEntity.ok() .headers(headers) .contentType(MediaType.APPLICATION_PDF) .body(new InputStreamResource(bis)); } catch (Exception e) { System.err.println("Erreur lors de la génération du fichier PDF : " + e.getMessage()); e.printStackTrace(); return ResponseEntity.status(500).build(); } } @GetMapping("/cumulativeLevelings") public ResponseEntity<InputStreamResource> generateCumulativeLevelingsReport() { try { CumulativeLevelingsReport report = cumulativeLevelingsServiceImpl.calculateMonthlyCumulativeLevelingsReport(1L, 1L, YearMonth.of(2025, 4)); List<CumulativeLevelingsReport> cumulativeReport = new ArrayList<>(); List<AccountCumulativeLevelingDetails> cumulatives = new ArrayList<>(); final String[] companyName = {""}; report.getAccountDetails() .forEach((s, accountCumulativeDetails) -> { if (accountCumulativeDetails != null) { AccountCumulativeLevelingDetails cumilative = new AccountCumulativeLevelingDetails(); cumilative.setCumulativeLevelingDebit(accountCumulativeDetails.getCumulativeLevelingDebit()); cumilative.setCumulativeLevelingCredit(accountCumulativeDetails.getCumulativeLevelingCredit()); cumilative.setCumulativeLevelingNet(accountCumulativeDetails.getCumulativeLevelingNet()); cumilative.setLastCumulativeLevelingDebit(accountCumulativeDetails.getLastCumulativeLevelingDebit()); cumilative.setLastCumulativeLevelingCredit(accountCumulativeDetails.getLastCumulativeLevelingCredit()); cumilative.setLastCumulativeLevelingNet(accountCumulativeDetails.getLastCumulativeLevelingNet()); cumilative.setCompanyName(accountCumulativeDetails.getCompanyName()); cumilative.setAccountNumber(accountCumulativeDetails.getAccountNumber()); companyName[0] =cumilative.getCompanyName(); if(accountCumulativeDetails.getCumulativeLevelingDebit().add(accountCumulativeDetails.getCumulativeLevelingCredit()).compareTo(BigDecimal.ZERO)!=0) cumulatives.add(cumilative); } }); Map<String, AccountCumulativeLevelingDetails> cumulativeMap = cumulatives.stream() .collect(Collectors.toMap( AccountCumulativeLevelingDetails::getAccountNumber, account -> account, (existing, replacement) -> existing )); cumulativeReport.add(new CumulativeLevelingsReport(report.getCurrency(), report.getGroupName(), "02992 - 21807 - 04488 - NCU - IS", "",report.getPivotAddress(),report.getPivotAccountNumber(),report.getFirstDate(),report.getLastDate(),companyName[0],null,null,null,null,null,null,null, cumulativeMap)); JRBeanCollectionDataSource dataSource = new JRBeanCollectionDataSource(cumulativeReport); JRBeanCollectionDataSource subReportDataSource = new JRBeanCollectionDataSource(cumulatives); Map<String, Object> parameters = new HashMap<>(); parameters.put("tableDataSource", subReportDataSource); parameters.put("pivotAddress", cumulativeReport.get(0) .getPivotAddress()); parameters.put("reportReference", cumulativeReport.get(0) .getReportReference()); parameters.put("groupName", cumulativeReport.get(0) .getGroupName()); parameters.put("pivotAccountNumber", cumulativeReport.get(0) .getPivotAccountNumber()); parameters.put("companyName", cumulativeReport.get(0) .getCompanyName()); parameters.put("firstDate", cumulativeReport.get(0) .getFirstDate()); parameters.put("lastDate", cumulativeReport.get(0) .getLastDate()); parameters.put("devise", cumulativeReport.get(0) .getCurrency()); InputStream jasperStream = this.getClass() .getResourceAsStream("/CumulativeLevelings.jrxml"); JasperReport jasperReport = JasperCompileManager.compileReport(jasperStream); JasperPrint jasperPrint = JasperFillManager.fillReport(jasperReport, parameters, dataSource); File outputDir = new File("engine-service/src/main/resources/reports"); if (!outputDir.exists()) { boolean created = outputDir.mkdirs(); System.out.println("Répertoire créé : " + created); } String outputFilePath = "engine-service/src/main/resources/reports/EtatCumuleIndiv.pdf"; JasperExportManager.exportReportToPdfFile(jasperPrint, outputFilePath); System.out.println("Fichier PDF généré avec succès : " + outputFilePath); ByteArrayOutputStream pdfOutputStream = new ByteArrayOutputStream(); JasperExportManager.exportReportToPdfStream(jasperPrint, pdfOutputStream); ByteArrayInputStream bis = new ByteArrayInputStream(pdfOutputStream.toByteArray()); HttpHeaders headers = new HttpHeaders(); headers.add("Content-Disposition", "inline; filename=cumule-indiv-report.pdf"); return ResponseEntity.ok() .headers(headers) .contentType(MediaType.APPLICATION_PDF) .body(new InputStreamResource(bis)); } catch (Exception e) { System.err.println("Erreur lors de la génération du fichier PDF : " + e.getMessage()); e.printStackTrace(); return ResponseEntity.status(500).build(); } } il reste dautre parties


************************************************************************


@GetMapping("/cumulativeLevelingsGroup") public ResponseEntity<InputStreamResource>generateCumulativeLevelingsGroupReport() { try { List<CumulativeLevelingsReport> listReport = new ArrayList<>(); for (Long i = 1L; i < 5L; i++) { CumulativeLevelingsReport report = cumulativeLevelingsServiceImpl.calculateMonthlyCumulativeLevelingsReport(1L, i, YearMonth.of(2025, 4)); listReport.add(report); } final BigDecimal[] lastTotalCumulativeCredit = {BigDecimal.ZERO}; final BigDecimal[] lastTotalCumulativeDebit = {BigDecimal.ZERO}; final BigDecimal[] lastTotalCumulativeNet = {BigDecimal.ZERO}; final BigDecimal[] totalCumulativeDebit = {BigDecimal.ZERO}; final BigDecimal[] totalCumulativeCredit = {BigDecimal.ZERO}; final BigDecimal[] totalCumulativeNet = {BigDecimal.ZERO}; final BigDecimal[] totalGeneral = {BigDecimal.ZERO}; final String[] currency = {""}; final String[] reportReference = {""}; final String[] groupName = {""}; final String[] companyName = {""}; final String[] pivotAddress = {""}; final String[] pivotAccountNumber = {""}; final LocalDate[] dates = {null, null}; List<CumulativeLevelingsReport> cumulativeReport = new ArrayList<>(); List<AccountCumulativeLevelingDetails> cumulatives = new ArrayList<>(); listReport.forEach(rep -> { currency[0] = rep.getCurrency(); reportReference[0] = rep.getReportReference(); groupName[0] = rep.getGroupName(); companyName[0] = rep.getCompanyName(); pivotAddress[0]=rep.getPivotAddress(); dates[0] = rep.getFirstDate(); dates[1] = rep.getLastDate(); pivotAccountNumber[0]=rep.getPivotAccountNumber(); rep.getAccountDetails() .forEach((s, accountCumulativeLevelingDetails) -> { if (accountCumulativeLevelingDetails != null) { AccountCumulativeLevelingDetails cumulative = new AccountCumulativeLevelingDetails(); cumulative.setCumulativeLevelingDebit(accountCumulativeLevelingDetails.getCumulativeLevelingDebit()); cumulative.setCumulativeLevelingCredit(accountCumulativeLevelingDetails.getCumulativeLevelingCredit()); cumulative.setCumulativeLevelingNet(accountCumulativeLevelingDetails.getCumulativeLevelingNet()); cumulative.setLastCumulativeLevelingCredit(accountCumulativeLevelingDetails.getLastCumulativeLevelingCredit()); cumulative.setLastCumulativeLevelingDebit(accountCumulativeLevelingDetails.getLastCumulativeLevelingDebit()); cumulative.setLastCumulativeLevelingNet(accountCumulativeLevelingDetails.getLastCumulativeLevelingNet()); cumulative.setCompanyName(accountCumulativeLevelingDetails.getCompanyName()); cumulative.setAccountNumber(accountCumulativeLevelingDetails.getAccountNumber()); cumulatives.add(cumulative); // lastTotalCumulativeCredit[0] = lastTotalCumulativeCredit[0].add(accountCumulativeLevelingDetails.getLastCumulativeLevelingDebit()); lastTotalCumulativeDebit[0] = lastTotalCumulativeDebit[0].add(accountCumulativeLevelingDetails.getLastCumulativeLevelingCredit()); lastTotalCumulativeNet[0] = lastTotalCumulativeNet[0].add(accountCumulativeLevelingDetails.getLastCumulativeLevelingNet()); totalCumulativeDebit[0] = totalCumulativeDebit[0].add(accountCumulativeLevelingDetails.getCumulativeLevelingCredit()); totalCumulativeCredit[0] = totalCumulativeCredit[0].add(accountCumulativeLevelingDetails.getCumulativeLevelingDebit()); totalCumulativeNet[0] = totalCumulativeNet[0].add(accountCumulativeLevelingDetails.getCumulativeLevelingNet()); totalGeneral[0] = totalGeneral[0] .add(accountCumulativeLevelingDetails.getCumulativeLevelingDebit() != null ? accountCumulativeLevelingDetails.getCumulativeLevelingDebit() : BigDecimal.ZERO) .add(accountCumulativeLevelingDetails.getCumulativeLevelingCredit() != null ? accountCumulativeLevelingDetails.getCumulativeLevelingCredit() : BigDecimal.ZERO); } }); } ); // Map<String, AccountInterestDetails> interestMap = interests.stream() // .collect(Collectors.toMap(AccountInterestDetails::getAccountNumber, account -> account)); Map<String, AccountCumulativeLevelingDetails> cumulativeMap = cumulatives.stream() .collect(Collectors.toMap( AccountCumulativeLevelingDetails::getAccountNumber, account -> account, (existing, replacement) -> existing )); cumulativeReport.add(new CumulativeLevelingsReport(currency[0], groupName[0], "02992 - 21807 - 04488 - NCU - RG", "", pivotAddress[0], pivotAccountNumber[0],dates[0], dates[1],companyName[0],lastTotalCumulativeCredit[0],lastTotalCumulativeDebit[0],lastTotalCumulativeNet[0],totalCumulativeDebit[0],totalCumulativeCredit[0],totalCumulativeNet[0],totalGeneral[0], cumulativeMap)); JRBeanCollectionDataSource dataSource = new JRBeanCollectionDataSource(cumulativeReport); JRBeanCollectionDataSource subReportDataSource = new JRBeanCollectionDataSource(cumulatives); Map<String, Object> parameters = new HashMap<>(); parameters.put("tableDataSource", subReportDataSource); parameters.put("pivotAddress", cumulativeReport.get(0) .getPivotAddress()); parameters.put("reportReference", cumulativeReport.get(0) .getReportReference()); parameters.put("groupName", cumulativeReport.get(0) .getGroupName()); parameters.put("pivotAccountNumber", cumulativeReport.get(0) .getPivotAccountNumber()); parameters.put("companyName", cumulativeReport.get(0) .getCompanyName()); parameters.put("firstDate", cumulativeReport.get(0) .getFirstDate()); parameters.put("lastDate", cumulativeReport.get(0) .getLastDate()); parameters.put("devise", cumulativeReport.get(0) .getCurrency()); // InputStream jasperStream = this.getClass() .getResourceAsStream("/CumulativeLevelingsGroup.jrxml"); JasperReport jasperReport = JasperCompileManager.compileReport(jasperStream); JasperPrint jasperPrint = JasperFillManager.fillReport(jasperReport, parameters, dataSource); File outputDir = new File("engine-service/src/main/resources/reports"); if (!outputDir.exists()) { boolean created = outputDir.mkdirs(); System.out.println("Répertoire créé : " + created); } String outputFilePath = "engine-service/src/main/resources/reports/EtatCumuleGroup.pdf"; JasperExportManager.exportReportToPdfFile(jasperPrint, outputFilePath); System.out.println("Fichier PDF généré avec succès : " + outputFilePath); ByteArrayOutputStream pdfOutputStream = new ByteArrayOutputStream(); JasperExportManager.exportReportToPdfStream(jasperPrint, pdfOutputStream); ByteArrayInputStream bis = new ByteArrayInputStream(pdfOutputStream.toByteArray()); HttpHeaders headers = new HttpHeaders(); headers.add("Content-Disposition", "inline; filename=cumule-group-report.pdf"); return ResponseEntity.ok() .headers(headers) .contentType(MediaType.APPLICATION_PDF) .body(new InputStreamResource(bis)); } catch (Exception e) { System.err.println("Erreur lors de la génération du fichier PDF : " + e.getMessage()); e.printStackTrace(); return ResponseEntity.status(500).build(); } } @GetMapping("/loanBorrowing") public ResponseEntity<InputStreamResource>generateLoanBorrowingReport() { try { ... } catch (Exception e) { System.err.println("Erreur lors de la génération du fichier PDF : " + e.getMessage()); e.printStackTrace(); return ResponseEntity.status(500).build(); } } @GetMapping("/loanBorrowingGroup") public ResponseEntity<InputStreamResource>generateLoanBorrowingGroupReport() { try { ... } catch (Exception e) { System.err.println("Erreur lors de la génération du fichier PDF : " + e.getMessage()); e.printStackTrace(); return ResponseEntity.status(500).build(); } } je vous envoie dautre code tt suite


*************************************
voila mes dtos @Getter @Setter @NoArgsConstructor @AllArgsConstructor @Builder public class ClientDTO { private Long id; private Long groupNum; private String groupName; private String currency; private String createdBy; private String modifiedBy; private LocalDateTime createdAt; private LocalDateTime modifiedAt; private String bic; private String codeClient; private String nomDocument; private AccountDTO accountDto; private String bank; private String statusClient; private String statusUpdated; private String cashPoolingType; private String typeSubmitted; private AddressDTO address; private List<SubsidiaryDTO> subsidiaries; private List<IntermediaryDTO> intermediaries; private List<EmailDto> emailDtos; } @Getter @Setter @NoArgsConstructor @AllArgsConstructor @Builder public class IntermediaryDTO { private Long id; private String name; private String numRib; private Long clientId; private AccountDTO accountDTO; private SubsidiaryDTO subsidiary; private AddressDTO address; }
@FeignClient(name = "subsidiaryService", url = "${subsidiary.service.url}") interface SubsidiaryServiceProxy { @GetMapping("/client/{clientId}") List<SubsidiaryDTO> getSubsidiariesByClientId(@PathVariable Long clientId); @GetMapping("/{subsidiaryId}") SubsidiaryDTO getSubsidiaryById(@PathVariable Long subsidiaryId); } @Service public class SubsidiaryServiceFeign { private final SubsidiaryServiceProxy subsidiaryServiceProxy; @Autowired public SubsidiaryServiceFeign(SubsidiaryServiceProxy subsidiaryServiceProxy) { this.subsidiaryServiceProxy = subsidiaryServiceProxy; } public List<SubsidiaryDTO> getSubsidiariesByClientId(Long clientId) { return this.subsidiaryServiceProxy.getSubsidiariesByClientId(clientId); } public SubsidiaryDTO getSubsidiaryById(Long subsidiaryId) { return this.subsidiaryServiceProxy.getSubsidiaryById(subsidiaryId); } } @FeignClient(name = "clientService", url = "${client.service.url}") interface ClientServiceProxy { @GetMapping("") List<ClientDTO> getClients(); @GetMapping("/{clientId}") ClientDTO getClientById(@PathVariable Long clientId); } @Service public class ClientServiceFeign { private final ClientServiceProxy clientServiceProxy; @Autowired public ClientServiceFeign(ClientServiceProxy clientServiceProxy) { this.clientServiceProxy = clientServiceProxy; } public List<ClientDTO> getAllClients() { return clientServiceProxy.getClients(); } public ClientDTO getClientById(Long clientId) { return this.clientServiceProxy.getClientById(clientId); } } merci de generer lapi
